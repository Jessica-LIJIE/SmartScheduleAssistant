
# 数据库设计文档（Database Design）

## 1. 数据库总体说明

- **数据库类型**：MySQL 8.x
- **字符集**：utf8mb4
- **存储内容**：
  - 用户基本信息（用于登录注册）
  - 用户个人任务信息
- **不存储聊天历史**（采用前端维护上下文的多轮对话方案）

---

## 2. 数据库 ER 关系说明

**实体关系**：
```
User (1) ─────── (N) Task
```

- 一个用户可以拥有多个任务
- 每个任务只属于一个用户

---

## 3. 数据表设计

### 3.1 用户表：`users`

**表说明**
存储系统用户的基本信息，用于登录与身份认证。

**表结构**

| 字段名         | 类型         | 约束                     | 说明               |
|----------------|--------------|--------------------------|--------------------|
| id             | BIGINT       | PK, AUTO_INCREMENT       | 用户唯一标识       |
| email          | VARCHAR(100) | UNIQUE, NOT NULL         | 用户邮箱（登录账号）|
| password_hash  | VARCHAR(255) | NOT NULL                 | 加密后的密码       |
| created_at     | DATETIME     | NOT NULL                 | 注册时间           |

**SQL 建表示例**
```sql
CREATE TABLE users (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  email VARCHAR(100) NOT NULL UNIQUE,
  password_hash VARCHAR(255) NOT NULL,
  created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

### 3.2 任务表：`tasks`

**表说明**
存储用户创建的个人任务及 AI 自动分类结果。

**表结构**

| 字段名     | 类型         | 约束                     | 说明               |
|------------|--------------|--------------------------|--------------------|
| id         | BIGINT       | PK, AUTO_INCREMENT       | 任务ID             |
| user_id    | BIGINT       | FK, NOT NULL             | 所属用户           |
| content    | VARCHAR(200) | NOT NULL                 | 任务内容           |
| category   | VARCHAR(50)  | NULL                     | AI 分类结果        |
| created_at | DATETIME     | NOT NULL                 | 创建时间           |

**外键关系**
```
tasks.user_id → users.id
```

**SQL 建表示例**
```sql
CREATE TABLE tasks (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  content VARCHAR(200) NOT NULL,
  category VARCHAR(50),
  created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT fk_task_user FOREIGN KEY (user_id)
    REFERENCES users(id)
    ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## 4. 数据库设计说明总结

- 表数量少（2 张），逻辑清晰
- 完全满足：
  - 用户认证
  - 用户数据隔离
  - AI 分类存储
- 不引入冗余字段，符合课程“从简但完整”的要求
